version: 0.2

env:
  variables:
    # Change 'tleavey-test-platform-status' to a folder name in your s3
    MY_S3_BUCKET: s3://tleavey-test-platform-status/
    MY_FOLDER_IN_S3BUCKET: cfnResults

phases:
  install:
    commands:
      - echo Installing boto3
      - pip install -U boto3
      - echo Finished installing boto3
  build:
    commands:
      - echo Going to sleep for 5 minutes.
      # - sleep 300
      - echo Just woke up.
      - echo Running status_checker.py
      - python status_checker.py
      - echo Status Checker Build Completed
  post_build:
    commands:
      - echo Setting public-read permissions on output
      - aws s3 mv --acl public-read cfn-stack-results.md $MY_S3_BUCKET/$MY_FOLDER_IN_S3BUCKET
      - aws s3 mv --acl public-read $MY_S3_BUCKET/$MY_FOLDER_IN_S3BUCKET/cfn-stack-results.md $MY_S3_BUCKET/cfn-stack-results.md
      - echo The cfn-stack-results have been moved successfully.
